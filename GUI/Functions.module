' Gambas module file

PUBLIC FUNCTION Get_Conf(tmpStr AS String) AS Variant
  DIM sLine, Result AS String
  DIM hFile AS File
  
  hFile = OPEN "/opt/Customizer/settings.conf" FOR INPUT 
  WHILE NOT Eof(hFile)
    LINE INPUT #hFile, sLine
    IF sLine LIKE tmpStr & "*" THEN 
      sLine = Replace$(sLine, "\"", "")
      Result = Replace$(sLine, tmpStr, "")
      BREAK 
    ENDIF 
  WEND
  
  RETURN Result

  CATCH 
    Message.Error("Unable to get value: " & tmpStr)
END

PUBLIC FUNCTION Get_Str(tFile AS String, tStr AS String) AS Variant
  DIM sLine, tmpStr, WorkDir, Result AS String
  DIM hFile AS File
  
  tmpStr = "WORK_DIR="
  WorkDir = Functions.Get_Conf(tmpStr)
  
  hFile = OPEN tFile FOR INPUT 
  WHILE NOT Eof(hFile)
    LINE INPUT #hFile, sLine
    IF sLine LIKE "*" & tStr & "*" THEN 
      sLine = Replace$(sLine, "\"", "")
      sLine = Replace$(sLine, "export ", "")
      Result = Replace$(sLine, tStr, "")
      BREAK 
    ENDIF 
  WEND
  
  RETURN Result

  CATCH 
    Message.Error("Unable to get info!\n\nFile: " & tFile & "\nString: " & tStr)
END