' Gambas class file


PUBLIC SUB Form_Open()
  ME.Center
  ME.Caption = "Settings"
  
  Check.Conf_File()
  
  IF Exist("/usr/bin/gedit") THEN
    EditorBox.Add("gedit")
  ENDIF 

  IF Exist("/usr/bin/medit") THEN
    EditorBox.Add("medit")
  ENDIF 
  
  IF Exist("/usr/bin/nedit") THEN
    EditorBox.Add("nedit")
  ENDIF 
  
  IF Exist("/usr/bin/mousepad") THEN
    EditorBox.Add("mousepad")
  ENDIF 
  
  IF Exist("/usr/bin/leafpad") THEN
    EditorBox.Add("leafpad")
  ENDIF 
  
  IF Exist("/usr/bin/geany") THEN
    EditorBox.Add("geany")
  ENDIF 
  
  IF Exist("/usr/bin/emacs") THEN
    EditorBox.Add("emacs")
  ENDIF 
  
  IF Exist("/usr/bin/kate") THEN
    EditorBox.Add("kate")
  ENDIF 
  
  IF Exist("/usr/bin/kwrite") THEN
    EditorBox.Add("kwrite")
  ENDIF 
  
  IF Exist("/usr/bin/bluefish") THEN
    EditorBox.Add("bluefish")
  ENDIF 
  
  IF Exist("/usr/bin/ultraedit") THEN
    EditorBox.Add("ultraedit")
  ENDIF 
  
  IF Exist("/usr/bin/scite") THEN
    EditorBox.Add("scite")
  ENDIF 
  
  IF Exist("/usr/bin/vi") THEN
    EditorBox.Add("vi")
  ENDIF 
  
  IF Exist("/usr/bin/vim") THEN
    EditorBox.Add("vim")
  ENDIF 
  
  IF Exist("/usr/bin/nano") THEN
    EditorBox.Add("nano")
  ENDIF 
  
  IF Exist("/usr/bin/pico") THEN
    EditorBox.Add("pico")
  ENDIF 
  
  TRY WorkDir.Text = Func.Get_Str("/opt/Customizer/settings.conf", "WORK_DIR=", "/home")
  TRY MountDir.Text = Func.Get_Str("/opt/Customizer/settings.conf", "MOUNT_DIR=", "/media/ISO")
  TRY UseColors.Value = Func.Get_Str("/opt/Customizer/settings.conf", "MESSAGES_COLORS=", "1")
  TRY ForceChroot.Value = Func.Get_Str("/opt/Customizer/settings.conf", "FORCE_CHROOT=", "0")
  TRY AptHelper.Value = Func.Get_Str("/opt/Customizer/settings.conf", "APT_HELPER=", "1")
  TRY EditorBox.Text = Func.Get_Str("/opt/Customizer/settings.conf", "EDITOR=", "nano")
  TRY BootFiles.Value = Func.Get_Str("/opt/Customizer/settings.conf", "BOOT_FILES=", "0")
  TRY VirtualMemBox.Text = Func.Get_Str("/opt/Customizer/settings.conf", "VRAM=", "256")
  TRY ResolutionBox.Text = Func.Get_Str("/opt/Customizer/settings.conf", "RESOLUTION=", "800x600")
  TRY CompressionBox.Text = Func.Get_Str("/opt/Customizer/settings.conf", "COMPRESSION=", "tar")
  
  IF FMain.Build_ISO.Enabled = TRUE THEN 
    Message.Warning("Changing the working directory while in the middle of\ncustomization proccess is a stupid idea! To prevent you\nfrom doing so and probably harm your host OS this feature\nwill be disabled and you will have to clean to change it.")
    Change_WDir.Enabled = FALSE
    Change_WDir.ToolTip = "Changing the working directory is not possible at that state!"
  ENDIF 
END

PUBLIC SUB UseColors_Click()
  IF UseColors.Value = 0 THEN 
    Func.Replace_Str("/opt/Customizer/settings.conf", "MESSAGES_COLORS=", "0")
  ELSE 
    Func.Replace_Str("/opt/Customizer/settings.conf", "MESSAGES_COLORS=", "1")
  ENDIF 
END

PUBLIC SUB ForceChroot_Click()
  IF ForceChroot.Value = 0 THEN 
    Func.Replace_Str("/opt/Customizer/settings.conf", "FORCE_CHROOT=", "0")
  ELSE 
    Func.Replace_Str("/opt/Customizer/settings.conf", "FORCE_CHROOT=", "1")
  ENDIF 
END

PUBLIC SUB AptHelper_Click()
  IF AptHelper.Value = 0 THEN 
    Func.Replace_Str("/opt/Customizer/settings.conf", "APT_HELPER=", "0")
  ELSE 
    Func.Replace_Str("/opt/Customizer/settings.conf", "APT_HELPER=", "1")
  ENDIF 
END

PUBLIC SUB BootFiles_Click()
  IF BootFiles.Value = 0 THEN 
    Func.Replace_Str("/opt/Customizer/settings.conf", "BOOT_FILES=", "0")
  ELSE 
    Func.Replace_Str("/opt/Customizer/settings.conf", "BOOT_FILES=", "1")
  ENDIF 
END

PUBLIC SUB ResolutionBox_Click()
  Func.Replace_Str("/opt/Customizer/settings.conf", "RESOLUTION=", ResolutionBox.Text)
END

PUBLIC SUB EditorBox_Click()
  Func.Replace_Str("/opt/Customizer/settings.conf", "EDITOR=", EditorBox.Text)
END

PUBLIC SUB VirtualMemBox_Click()
  Func.Replace_Str("/opt/Customizer/settings.conf", "VRAM=", VirtualMemBox.Text)
END

PUBLIC SUB Change_WDir_Click()
  DIM WDir AS String

  WDir = Func.Get_Str("/opt/Customizer/settings.conf", "WORK_DIR=", "/home")
  
  Dialog.Title = "Please, select work directory"
  
  IF Exist(WDir) THEN 
    Dialog.Path = WDir
  ELSE 
    Dialog.Path = "/home"
  ENDIF 
  
  IF Dialog.SelectDirectory() THEN RETURN 
  Func.Replace_Str("/opt/Customizer/settings.conf", "WORK_DIR=", Dialog.Path)
  WorkDir.Text = Dialog.Path
END

PUBLIC SUB Change_MDir_Click()
  DIM MDir AS String
  
  MDir = Func.Get_Str("/opt/Customizer/settings.conf", "MOUNT_DIR=", "/media/ISO")
  
  Dialog.Title = "Please, select work directory"
  
  IF Exist(MDir) THEN 
    Dialog.Path = MDir
  ELSE 
    Dialog.Path = "/home"
  ENDIF 
  
  IF Dialog.SelectDirectory() THEN RETURN 
  Func.Replace_Str("/opt/Customizer/settings.conf", "MOUNT_DIR=", Dialog.Path)
  MountDir.Text = Dialog.Path
END

PUBLIC SUB CompressionBox_Click()
  Func.Replace_Str("/opt/Customizer/settings.conf", "COMPRESSION=", CompressionBox.Text)
END

PUBLIC SUB Quit_Click()
  ME.Close
END
